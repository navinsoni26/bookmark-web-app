<div class="collection-container">
  <h2 class="heading-1">Collections</h2>
  <div class="search-box mb">
    <input type="text" class="search-box__input" [formControl]="searchCollectionInput" placeholder="Search Collection by Name or No. of Bookmarks">
    <div class="search-box__icon-container">
        <svg class="search-box__icon" >
            <use 
            xlink:href="assets/sprite.svg#icon-search" >
            </use>
        </svg>
    </div>
    
</div>
  <table class="table">
    <thead class="table-head">
      <tr>
        <th style="width: 30%;">Name</th>
        <th >No. Of Bookmarks</th>
        <th >Show in Collection List</th>
        <th >Actions</th>
      </tr>
    </thead>
    <tbody class="table-body">
      <!-- Parent row container starts here  -->
      <ng-container *ngFor="let collection of list; index as i">
        <tr>
          <td class="name-column">
            <div>
              <svg class="expand-icon" (click)="expandCollapseArray[i] = !expandCollapseArray[i]" *ngIf="collection.children.length > 0 && expandCollapseArray[i]">
                <use
                  xlink:href="assets/sprite.svg#icon-caret-down"
                ></use>
              </svg>
              <svg class="expand-icon" (click)="expandCollapseArray[i] = !expandCollapseArray[i]" *ngIf="collection.children.length > 0 && !expandCollapseArray[i]">
                <use
                  xlink:href="assets/sprite.svg#icon-caret-right"
                ></use>
              </svg>
              <span>{{ collection.name }}</span>
            </div>
            
          </td>
          <td class="count-column">{{ collection.count }}</td>
          <td>
            <label class="switch">
              <input type="checkbox" [checked]="collection.show" (change)="onParentSwitchChange(collection)"/>
              <span class="slider round"></span>
            </label>
          </td>
          <td class="action-column">
            <!-- Edit  -->
            <div class="icon-btn" (click)="onAction(eCollectionAction.Edit, collection)">
              <svg class="icon-btn__icon">
                <use xlink:href="assets/sprite.svg#icon-edit"></use>
              </svg>
              <div class="icon-btn__text">Edit</div>
            </div>
            <!-- Share  -->
            <div class="icon-btn" (click)="onAction(eCollectionAction.Share, collection)">
              <svg class="icon-btn__icon">
                <use xlink:href="assets/sprite.svg#icon-share"></use>
              </svg>
              <div class="icon-btn__text">Share</div>
            </div>
            <!-- Delete  -->
            <div class="icon-btn" (click)="onAction(eCollectionAction.Delete, collection)">
              <svg class="icon-btn__icon">
                <use xlink:href="assets/sprite.svg#icon-delete"></use>
              </svg>
              <div class="icon-btn__text">Delete</div>
            </div>
          </td>
        </tr>

        <!-- Children row container starts here -->
        <ng-container *ngIf="collection.children.length > 0">
          <tr *ngFor="let child of collection.children" style="background-color: #f0f0f0;" [ngStyle]="{'display' : expandCollapseArray[i] ? '' : 'none'}">
            <td class="name-column--child">{{ child.name }}</td>
            <td>{{ child.count }}</td>
            <td>
              <label class="switch">
                <input type="checkbox" [checked]="child.show" (change)="onChildSwitchChange(child)" />
                <span class="slider round"></span>
              </label>
            </td>
            <td class="action-column">
              <!-- Edit  -->
              <div class="icon-btn" (click)="onAction(eCollectionAction.Edit, child)">
                <svg class="icon-btn__icon">
                  <use xlink:href="assets/sprite.svg#icon-edit"></use>
                </svg>
                <div class="icon-btn__text">Edit</div>
              </div>
              <!-- Share  -->
              <div class="icon-btn" (click)="onAction(eCollectionAction.Share, child)">
                <svg class="icon-btn__icon">
                  <use xlink:href="assets/sprite.svg#icon-share"></use>
                </svg>
                <div class="icon-btn__text">Share</div>
              </div>
              <!-- Delete  -->
              <div class="icon-btn" (click)="onAction(eCollectionAction.Delete, child)">
                <svg class="icon-btn__icon">
                  <use xlink:href="assets/sprite.svg#icon-delete"></use>
                </svg>
                <div class="icon-btn__text">Delete</div>
              </div>
            </td>
          </tr>
        </ng-container>
        <!-- Children row container ends here -->
      </ng-container>
      <!-- Parent row container ends here -->
    </tbody>
  </table>
</div>
<app-collection-delete *ngIf="showDeleteDialog" [collectionToDelete]="currentCollection" (onDeleteDialogClosed)="closeDeleteDialog($event)"></app-collection-delete>
<app-collection-add-edit *ngIf="showFormDialog" [isNewCollection]="false" [collection]="currentCollection" (onCollectionFormClosed)="closeFormDialog($event)"></app-collection-add-edit>